<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Sushi Express - Menú Optimizado</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #e53935;
            --primary-dark: #c62828;
            --secondary: #2c3e50;
            --accent: #fbc02d;
            --light: #f5f5f5;
            --dark: #212121;
            --success: #4caf50;
            --warning: #ff9800;
            --border-radius: 12px;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            --shadow-light: 0 2px 8px rgba(0, 0, 0, 0.08);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }

        body {
            background-color: #fefefe;
            color: #333;
            line-height: 1.5;
            -webkit-tap-highlight-color: transparent;
        }

        .container {
            max-width: 100%;
            margin: 0 auto;
            padding: 0 16px;
        }

        /* Header estilo sushi */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 1rem 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 4px solid var(--accent);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo-icon {
            font-size: 1.8rem;
            color: var(--accent);
            transform: rotate(90deg);
        }

        .logo-text {
            font-size: 1.4rem;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .logo-subtext {
            font-size: 0.7rem;
            opacity: 0.9;
            font-weight: 400;
        }

        /* Botones móviles */
        .mobile-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .mobile-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        /* Panel de categorías */
        .category-panel {
            position: fixed;
            top: 0;
            left: -100%;
            width: 85%;
            height: 100vh;
            background-color: white;
            box-shadow: 5px 0 20px rgba(0, 0, 0, 0.15);
            padding: 1.5rem;
            transition: left 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 200;
            overflow-y: auto;
            border-right: 4px solid var(--accent);
        }

        .category-panel.active {
            left: 0;
        }

        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--light);
        }

        .panel-header h2 {
            color: var(--secondary);
            font-size: 1.5rem;
        }

        .close-panel {
            background: none;
            border: none;
            font-size: 1.5rem;
            color: var(--primary);
            cursor: pointer;
        }

        .category-list {
            list-style: none;
        }

        .category-list li {
            margin-bottom: 0.8rem;
        }

        .category-list a {
            display: flex;
            align-items: center;
            gap: 15px;
            text-decoration: none;
            color: var(--dark);
            font-weight: 600;
            font-size: 1.1rem;
            padding: 1rem;
            border-radius: var(--border-radius);
            transition: all 0.3s ease;
            background-color: #f9f9f9;
            cursor: pointer;
        }

        .category-list a:hover,
        .category-list a.active {
            background-color: var(--primary);
            color: white;
            transform: translateX(5px);
        }

        .category-list i {
            width: 24px;
            color: var(--primary);
        }

        .category-list a:hover i,
        .category-list a.active i {
            color: white;
        }

        /* Panel de filtros */
        .filter-panel {
            position: fixed;
            top: 0;
            right: -100%;
            width: 90%;
            height: 100vh;
            background-color: white;
            box-shadow: -5px 0 20px rgba(0, 0, 0, 0.15);
            padding: 1.5rem;
            transition: right 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            z-index: 200;
            overflow-y: auto;
            border-left: 4px solid var(--accent);
        }

        .filter-panel.active {
            right: 0;
        }

        .filter-group {
            margin-bottom: 2rem;
        }

        .filter-group h3 {
            margin-bottom: 1rem;
            color: var(--secondary);
            font-size: 1.2rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-group h3 i {
            color: var(--primary);
        }

        .filter-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .filter-option {
            padding: 0.7rem 1.2rem;
            background-color: #f0f0f0;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            font-weight: 500;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .filter-option:hover {
            background-color: #e0e0e0;
        }

        .filter-option.active {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Overlay */
        .panel-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 150;
            display: none;
            backdrop-filter: blur(2px);
        }

        .panel-overlay.active {
            display: block;
        }

        /* Contenido principal */
        main {
            padding: 1.5rem 0 4rem;
        }

        .menu-title {
            text-align: center;
            margin-bottom: 1.5rem;
            color: var(--secondary);
            position: relative;
            padding-bottom: 1rem;
        }

        .menu-title:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 4px;
            background-color: var(--accent);
            border-radius: 2px;
        }

        .menu-title span {
            color: var(--primary);
        }

        /* Filtros activos */
        .active-filters {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 1.5rem;
            align-items: center;
            padding: 1rem;
            background-color: #f9f9f9;
            border-radius: var(--border-radius);
        }

        .active-filters span {
            font-weight: 600;
            color: var(--primary);
            font-size: 0.9rem;
        }

        .filter-tag {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background-color: var(--primary);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 30px;
            font-size: 0.85rem;
            font-weight: 500;
        }

        .filter-tag i {
            cursor: pointer;
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .clear-filters {
            background-color: #e0e0e0;
            color: var(--dark);
            border: none;
            padding: 0.5rem 1rem;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 500;
            font-size: 0.85rem;
            transition: all 0.3s ease;
            margin-left: auto;
        }

        .clear-filters:hover {
            background-color: #d0d0d0;
        }

        /* Grid de menú */
        .menu-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 500px) {
            .menu-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 768px) {
            .container {
                max-width: 720px;
            }
            
            .menu-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .category-panel {
                width: 300px;
            }
            
            .filter-panel {
                width: 350px;
            }
        }

        /* Items del menú */
        .menu-item {
            background-color: white;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow-light);
            transition: all 0.3s ease;
            border: 1px solid #eee;
            position: relative;
        }

        .menu-item:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow);
        }

        .menu-item-image {
            height: 160px;
            width: 100%;
            background-size: cover;
            background-position: center;
            position: relative;
        }

        .menu-item-image:after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 40px;
            background: linear-gradient(to top, rgba(0,0,0,0.1), transparent);
        }

        .menu-item-content {
            padding: 1.2rem;
        }

        .menu-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.8rem;
        }

        .menu-item-title {
            font-size: 1.1rem;
            color: var(--secondary);
            font-weight: 700;
            flex: 1;
            line-height: 1.3;
        }

        .menu-item-price {
            font-size: 1.3rem;
            font-weight: 800;
            color: var(--primary);
            margin-left: 10px;
        }

        .menu-item-desc {
            color: #666;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .menu-item-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .menu-tag {
            font-size: 0.7rem;
            padding: 0.3rem 0.7rem;
            border-radius: 20px;
            font-weight: 600;
        }

        .vegano { background-color: #4caf50; color: white; }
        .vegetariano { background-color: #8bc34a; color: white; }
        .sin-gluten { background-color: #ff9800; color: white; }
        .sin-lactosa { background-color: #9c27b0; color: white; }
        .bajo-sodio { background-color: #2196f3; color: white; }
        .sin-pescado { background-color: #3f51b5; color: white; }
        .sin-soya { background-color: #795548; color: white; }
        .picante { background-color: #f44336; color: white; }

        /* Footer */
        footer {
            background-color: var(--secondary);
            color: white;
            padding: 2rem 0;
            margin-top: 3rem;
            text-align: center;
            border-top: 4px solid var(--accent);
        }

        .footer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 1rem;
        }

        .footer-logo {
            font-size: 1.3rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .footer-logo i {
            color: var(--accent);
            transform: rotate(90deg);
        }

        .footer-info {
            font-size: 0.85rem;
            opacity: 0.8;
            max-width: 300px;
            line-height: 1.4;
        }

        /* Botón flotante para filtros en móvil */
        .floating-filter-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--primary);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 15px rgba(229, 57, 53, 0.4);
            z-index: 100;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .floating-filter-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(229, 57, 53, 0.6);
        }

        /* Mensaje sin resultados */
        .no-results {
            grid-column: 1 / -1;
            text-align: center;
            padding: 3rem 1rem;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-light);
        }

        .no-results i {
            font-size: 3rem;
            color: #ddd;
            margin-bottom: 1rem;
        }

        .no-results h3 {
            color: var(--secondary);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .no-results p {
            color: #666;
            margin-bottom: 1.5rem;
        }

        /* Badge de nuevo o popular */
        .item-badge {
            position: absolute;
            top: 12px;
            left: 12px;
            background: var(--accent);
            color: var(--secondary);
            font-weight: 800;
            font-size: 0.7rem;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            z-index: 1;
        }

        /* Indicador de filtros activos */
        .filter-indicator {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--accent);
            color: var(--secondary);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 800;
        }

        /* Indicador de categoría activa */
        .category-indicator {
            position: absolute;
            top: -5px;
            left: -5px;
            background: var(--accent);
            color: var(--secondary);
            width: 20px;
            height: 20px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 800;
        }

        /* Contador de items por categoría */
        .category-count {
            background: var(--primary);
            color: white;
            font-size: 0.7rem;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            margin-left: auto;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container header-content">
            <div style="position: relative;">
                <button class="mobile-btn" id="categoryToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="category-indicator" id="categoryIndicator" style="display: none;">1</div>
            </div>
            
            <div class="logo">
                <i class="fas fa-fish logo-icon"></i>
                <div>
                    <div class="logo-text">SUSHI EXPRESS</div>
                    <div class="logo-subtext">Menú optimizado</div>
                </div>
            </div>
            
            <div style="position: relative;">
                <button class="mobile-btn" id="filterToggle">
                    <i class="fas fa-filter"></i>
                </button>
                <div class="filter-indicator" id="filterIndicator" style="display: none;">0</div>
            </div>
        </div>
    </header>

    <!-- Panel de Categorías -->
    <div class="category-panel" id="categoryPanel">
        <div class="panel-header">
            <h2><i class="fas fa-utensils"></i> Categorías</h2>
            <button class="close-panel" id="closeCategory">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <ul class="category-list" id="categoryList">
            <!-- Las categorías se cargarán dinámicamente -->
        </ul>
    </div>

    <!-- Panel de Filtros -->
    <div class="filter-panel" id="filterPanel">
        <div class="panel-header">
            <h2><i class="fas fa-filter"></i> Filtros</h2>
            <button class="close-panel" id="closeFilter">
                <i class="fas fa-times"></i>
            </button>
        </div>
        
        <div class="filter-group">
            <h3><i class="fas fa-heart"></i> Preferencias</h3>
            <div class="filter-options">
                <div class="filter-option" data-filter="vegetariano">
                    <i class="fas fa-leaf"></i> Vegetariano
                </div>
                <div class="filter-option" data-filter="vegano">
                    <i class="fas fa-seedling"></i> Vegano
                </div>
                <div class="filter-option" data-filter="sin-gluten">
                    <i class="fas fa-bread-slice"></i> Sin Gluten
                </div>
                <div class="filter-option" data-filter="sin-lactosa">
                    <i class="fas fa-cheese"></i> Sin Lactosa
                </div>
            </div>
        </div>
        
        <div class="filter-group">
            <h3><i class="fas fa-allergies"></i> Alergias/Restricciones</h3>
            <div class="filter-options">
                <div class="filter-option" data-filter="sin-pescado">
                    <i class="fas fa-fish"></i> Sin Pescado
                </div>
                <div class="filter-option" data-filter="sin-soya">
                    <i class="fas fa-seedling"></i> Sin Soya
                </div>
                <div class="filter-option" data-filter="bajo-sodio">
                    <i class="fas fa-prescription-bottle"></i> Bajo en Sodio
                </div>
            </div>
        </div>
        
        <div class="filter-group">
            <h3><i class="fas fa-pepper-hot"></i> Nivel Picante</h3>
            <div class="filter-options">
                <div class="filter-option" data-filter="picante">
                    <i class="fas fa-pepper-hot"></i> Picante
                </div>
                <div class="filter-option" data-filter="no-picante">
                    <i class="fas fa-pepper-hot"></i> No Picante
                </div>
            </div>
        </div>
        
        <button class="filter-option active" style="width: 100%; background: var(--primary); color: white; justify-content: center; margin-top: 1rem;" id="applyFilters">
            <i class="fas fa-check"></i> Aplicar Filtros
        </button>
    </div>

    <!-- Overlay -->
    <div class="panel-overlay" id="panelOverlay"></div>

    <!-- Contenido Principal -->
    <main class="container">
        <h1 class="menu-title">Nuestro <span>Menú de Sushi</span></h1>
        
        <div class="active-filters" id="activeFilters">
            <span>Filtros activos:</span>
            <div style="font-size: 0.9rem; color: #666; margin-left: 8px;" id="activeFiltersText">Ninguno</div>
        </div>
        
        <div class="menu-grid" id="menuGrid">
            <!-- Los elementos del menú se cargarán aquí dinámicamente -->
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container footer-content">
            <div class="footer-logo">
                <i class="fas fa-fish"></i> SUSHI EXPRESS
            </div>
            <div class="footer-info">
                Menú optimizado para tus preferencias alimentarias. Fresco, rápido y delicioso.
            </div>
        </div>
    </footer>

    <!-- Botón flotante para filtros -->
    <button class="floating-filter-btn" id="floatingFilterBtn">
        <i class="fas fa-filter"></i>
    </button>

    <script>
        // Datos del menú de sushi
        const menuItems = [
            {
                id: 1,
                name: "Roll California",
                description: "Cangrejo, palta, pepino y masago, envuelto en arroz y algas nori.",
                price: "$8.990",
                image: "https://images.unsplash.com/photo-1579584425555-c3ce17fd4351?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "sushi-roll",
                tags: ["sin-gluten"],
                badge: "Popular"
            },
            {
                id: 2,
                name: "Roll Vegetariano",
                description: "Palta, zanahoria, pepino y espinaca fresca. Opción vegana disponible.",
                price: "$7.990",
                image: "https://images.unsplash.com/photo-1546069901-ba9599a7e63c?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "sushi-roll",
                tags: ["vegetariano", "vegano", "sin-lactosa", "sin-gluten"]
            },
            {
                id: 3,
                name: "Sashimi de Salmón",
                description: "Frescas láminas de salmón de primera calidad. Acompañado de wasabi y jengibre.",
                price: "$12.990",
                image: "https://images.unsplash.com/photo-1563612116622-0d4e15660a8d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "sashimi",
                tags: ["sin-gluten", "bajo-sodio"],
                badge: "Nuevo"
            },
            {
                id: 4,
                name: "Nigiri de Atún",
                description: "Arroz prensado con una lonja de atún fresco sobre la superficie.",
                price: "$9.990",
                image: "https://images.unsplash.com/photo-1579584425555-c3ce17fd4351?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "nigiri",
                tags: ["sin-gluten", "bajo-sodio"]
            },
            {
                id: 5,
                name: "Roll Tempura Picante",
                description: "Camarón tempura, palta y pepino, con salsa picante especial.",
                price: "$10.990",
                image: "https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "picante",
                tags: ["picante", "sin-lactosa"]
            },
            {
                id: 6,
                name: "Roll Philadelphia",
                description: "Salmón fresco, queso crema y pepino. Suave y cremoso.",
                price: "$11.990",
                image: "https://images.unsplash.com/photo-1563379091339-03246963d9d6?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "sushi-roll",
                tags: ["sin-gluten"]
            },
            {
                id: 7,
                name: "Miso Ramen",
                description: "Sopa de miso con fideos ramen, huevo, naruto y vegetales.",
                price: "$9.490",
                image: "https://images.unsplash.com/photo-1569718212165-3a8278d5f624?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "sopas",
                tags: ["sin-lactosa", "vegetariano"],
                badge: "Recomendado"
            },
            {
                id: 8,
                name: "Roll Dynamite",
                description: "Camarón, palta y pepino con salsa dynamite picante por encima.",
                price: "$10.490",
                image: "https://images.unsplash.com/photo-1565299624946-b28f40a0ca4b?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "picante",
                tags: ["picante", "sin-gluten"]
            },
            {
                id: 9,
                name: "Edamame",
                description: "Vainas de soya tierna cocidas al vapor con sal marina.",
                price: "$4.990",
                image: "https://images.unsplash.com/photo-1586201375761-83865001e311?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "entradas",
                tags: ["vegano", "vegetariano", "sin-gluten", "sin-lactosa"]
            },
            {
                id: 10,
                name: "Roll Rainbow",
                description: "Roll California cubierto con láminas de salmón, atún y palta.",
                price: "$13.990",
                image: "https://images.unsplash.com/photo-1579584425555-c3ce17fd4351?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "especiales",
                tags: ["sin-gluten"],
                badge: "Especial"
            },
            {
                id: 11,
                name: "Té Verde Japonés",
                description: "Té verde de alta calidad, servido caliente.",
                price: "$2.990",
                image: "https://images.unsplash.com/photo-1559177581-515ac5c5c0b9?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "bebidas",
                tags: ["vegano", "vegetariano", "sin-gluten", "sin-lactosa", "bajo-sodio"]
            },
            {
                id: 12,
                name: "Mochi de Té Verde",
                description: "Postre japonés tradicional de arroz glutinoso con relleno de té verde.",
                price: "$5.990",
                image: "https://images.unsplash.com/photo-1565958011703-44f9829ba187?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "postres",
                tags: ["vegetariano", "sin-lactosa"]
            },
            {
                id: 13,
                name: "Sashimi Mixto",
                description: "Selección de salmón, atún y pez mantequilla. Frescura garantizada.",
                price: "$15.990",
                image: "https://images.unsplash.com/photo-1563612116622-0d4e15660a8d?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "sashimi",
                tags: ["sin-gluten", "bajo-sodio"],
                badge: "Del Chef"
            },
            {
                id: 14,
                name: "Roll Dragon",
                description: "Camarón tempura, pepino y aguacate, cubierto con láminas de anguila.",
                price: "$13.490",
                image: "https://images.unsplash.com/photo-1579584425555-c3ce17fd4351?ixlib=rb-4.0.3&auto=format&fit=crop&w=600&q=80",
                category: "especiales",
                tags: ["sin-gluten"],
                badge: "Especial"
            }
        ];

        // Categorías disponibles
        const categories = [
            { id: "sushi-roll", name: "Sushi Roll", icon: "fas fa-fish", count: 0 },
            { id: "picante", name: "Picante", icon: "fas fa-pepper-hot", count: 0 },
            { id: "especiales", name: "Especiales", icon: "fas fa-crown", count: 0 },
            { id: "sashimi", name: "Sashimi", icon: "fas fa-water", count: 0 },
            { id: "nigiri", name: "Nigiri", icon: "fas fa-seedling", count: 0 },
            { id: "sopas", name: "Sopas", icon: "fas fa-mug-hot", count: 0 },
            { id: "bebidas", name: "Bebidas", icon: "fas fa-glass-whiskey", count: 0 },
            { id: "postres", name: "Postres", icon: "fas fa-ice-cream", count: 0 },
            { id: "todos", name: "Todos los Platos", icon: "fas fa-utensils", count: 0 }
        ];

        // Estado de la aplicación
        let activeFilters = {
            preferences: [],
            restrictions: [],
            spice: []
        };
        
        let activeCategory = "todos"; // Categoría activa por defecto

        // Elementos del DOM
        const categoryToggle = document.getElementById('categoryToggle');
        const filterToggle = document.getElementById('filterToggle');
        const floatingFilterBtn = document.getElementById('floatingFilterBtn');
        const categoryPanel = document.getElementById('categoryPanel');
        const filterPanel = document.getElementById('filterPanel');
        const closeCategory = document.getElementById('closeCategory');
        const closeFilter = document.getElementById('closeFilter');
        const panelOverlay = document.getElementById('panelOverlay');
        const menuGrid = document.getElementById('menuGrid');
        const activeFiltersContainer = document.getElementById('activeFilters');
        const activeFiltersText = document.getElementById('activeFiltersText');
        const applyFiltersBtn = document.getElementById('applyFilters');
        const filterOptions = document.querySelectorAll('.filter-option');
        const filterIndicator = document.getElementById('filterIndicator');
        const categoryIndicator = document.getElementById('categoryIndicator');
        const categoryList = document.getElementById('categoryList');

        // Funciones para mostrar/ocultar paneles
        function showCategoryPanel() {
            categoryPanel.classList.add('active');
            panelOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function hideCategoryPanel() {
            categoryPanel.classList.remove('active');
            panelOverlay.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        function showFilterPanel() {
            filterPanel.classList.add('active');
            panelOverlay.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function hideFilterPanel() {
            filterPanel.classList.remove('active');
            panelOverlay.classList.remove('active');
            document.body.style.overflow = 'auto';
        }

        // Event Listeners para paneles
        categoryToggle.addEventListener('click', showCategoryPanel);
        filterToggle.addEventListener('click', showFilterPanel);
        floatingFilterBtn.addEventListener('click', showFilterPanel);
        closeCategory.addEventListener('click', hideCategoryPanel);
        closeFilter.addEventListener('click', hideFilterPanel);
        panelOverlay.addEventListener('click', () => {
            hideCategoryPanel();
            hideFilterPanel();
        });

        // Manejo de filtros
        filterOptions.forEach(option => {
            // Evitar el botón de aplicar filtros
            if (option.id !== 'applyFilters') {
                option.addEventListener('click', function() {
                    this.classList.toggle('active');
                });
            }
        });

        // Aplicar filtros
        applyFiltersBtn.addEventListener('click', () => {
            // Resetear filtros activos
            activeFilters.preferences = [];
            activeFilters.restrictions = [];
            activeFilters.spice = [];
            
            // Obtener filtros seleccionados
            const selectedOptions = document.querySelectorAll('.filter-option.active');
            selectedOptions.forEach(option => {
                if (option.id !== 'applyFilters') {
                    const filterValue = option.getAttribute('data-filter');
                    
                    // Categorizar filtros
                    if (['vegetariano', 'vegano', 'sin-gluten', 'sin-lactosa'].includes(filterValue)) {
                        activeFilters.preferences.push(filterValue);
                    } else if (['sin-pescado', 'sin-soya', 'bajo-sodio'].includes(filterValue)) {
                        activeFilters.restrictions.push(filterValue);
                    } else if (['picante', 'no-picante'].includes(filterValue)) {
                        activeFilters.spice.push(filterValue);
                    }
                }
            });
            
            // Actualizar interfaz
            updateActiveFiltersDisplay();
            renderMenuItems();
            updateFilterIndicator();
            hideFilterPanel();
        });

        // Actualizar display de filtros activos
        function updateActiveFiltersDisplay() {
            // Obtener todos los filtros activos
            const allActiveFilters = [...activeFilters.preferences, ...activeFilters.restrictions, ...activeFilters.spice];
            
            if (allActiveFilters.length === 0) {
                activeFiltersText.textContent = "Ninguno";
                return;
            }
            
            // Crear texto descriptivo
            const filterNames = {
                'vegano': 'Vegano',
                'vegetariano': 'Vegetariano',
                'sin-gluten': 'Sin Gluten',
                'sin-lactosa': 'Sin Lactosa',
                'sin-pescado': 'Sin Pescado',
                'sin-soya': 'Sin Soya',
                'bajo-sodio': 'Bajo Sodio',
                'picante': 'Picante',
                'no-picante': 'No Picante'
            };
            
            const filterTexts = allActiveFilters.map(filter => filterNames[filter] || filter);
            activeFiltersText.textContent = filterTexts.join(", ");
        }

        // Actualizar indicador de filtros activos
        function updateFilterIndicator() {
            const allActiveFilters = [...activeFilters.preferences, ...activeFilters.restrictions, ...activeFilters.spice];
            
            if (allActiveFilters.length > 0) {
                filterIndicator.textContent = allActiveFilters.length;
                filterIndicator.style.display = 'flex';
            } else {
                filterIndicator.style.display = 'none';
            }
        }

        // Actualizar indicador de categoría activa
        function updateCategoryIndicator() {
            if (activeCategory !== "todos") {
                const categoryName = categories.find(cat => cat.id === activeCategory)?.name || "";
                categoryIndicator.textContent = "1";
                categoryIndicator.style.display = 'flex';
            } else {
                categoryIndicator.style.display = 'none';
            }
        }

        // Crear lista de categorías dinámicamente
        function createCategoryList() {
            // Calcular conteos por categoría
            categories.forEach(category => {
                if (category.id === "todos") {
                    category.count = menuItems.length;
                } else {
                    category.count = menuItems.filter(item => item.category === category.id).length;
                }
            });
            
            // Limpiar lista
            categoryList.innerHTML = '';
            
            // Crear elementos de categoría
            categories.forEach(category => {
                const li = document.createElement('li');
                const isActive = category.id === activeCategory;
                
                li.innerHTML = `
                    <a href="#" class="${isActive ? 'active' : ''}" data-category="${category.id}">
                        <i class="${category.icon}"></i>
                        ${category.name}
                        <span class="category-count">${category.count}</span>
                    </a>
                `;
                
                categoryList.appendChild(li);
            });
            
            // Añadir event listeners a las categorías
            document.querySelectorAll('.category-list a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const categoryId = this.getAttribute('data-category');
                    
                    // Actualizar categoría activa
                    activeCategory = categoryId;
                    
                    // Actualizar UI
                    updateCategoryUI();
                    renderMenuItems();
                    hideCategoryPanel();
                });
            });
        }

        // Actualizar UI de categorías
        function updateCategoryUI() {
            // Actualizar clases activas
            document.querySelectorAll('.category-list a').forEach(link => {
                const categoryId = link.getAttribute('data-category');
                if (categoryId === activeCategory) {
                    link.classList.add('active');
                } else {
                    link.classList.remove('active');
                }
            });
            
            // Actualizar indicador
            updateCategoryIndicator();
        }

        // Filtrar por categoría y filtros
        function getFilteredItems() {
            return menuItems.filter(item => {
                // Filtrar por categoría
                const categoryMatch = activeCategory === "todos" || item.category === activeCategory;
                
                // Si no hay filtros activos, devolver match de categoría
                if (activeFilters.preferences.length === 0 && 
                    activeFilters.restrictions.length === 0 && 
                    activeFilters.spice.length === 0) {
                    return categoryMatch;
                }
                
                // Verificar filtros de preferencias
                const preferenceMatch = activeFilters.preferences.length === 0 || 
                                   activeFilters.preferences.some(filter => item.tags.includes(filter));
                
                // Verificar filtros de restricciones (excluir si tiene algo que no puede comer)
                let restrictionMatch = true;
                if (activeFilters.restrictions.length > 0) {
                    // Si el usuario no puede comer pescado, excluir items con pescado
                    if (activeFilters.restrictions.includes('sin-pescado')) {
                        // Asumimos que estos items tienen pescado
                        const fishItems = ["Roll California", "Sashimi de Salmón", "Nigiri de Atún", "Roll Philadelphia", "Roll Rainbow", "Sashimi Mixto", "Roll Dragon"];
                        if (fishItems.includes(item.name)) {
                            restrictionMatch = false;
                        }
                    }
                    
                    // Si el usuario no puede comer soya, excluir edamame
                    if (activeFilters.restrictions.includes('sin-soya') && item.name === "Edamame") {
                        restrictionMatch = false;
                    }
                }
                
                // Verificar filtros de picante
                let spiceMatch = true;
                if (activeFilters.spice.length > 0) {
                    if (activeFilters.spice.includes('picante') && !item.tags.includes('picante')) {
                        spiceMatch = false;
                    }
                    if (activeFilters.spice.includes('no-picante') && item.tags.includes('picante')) {
                        spiceMatch = false;
                    }
                }
                
                return categoryMatch && preferenceMatch && restrictionMatch && spiceMatch;
            });
        }

        // Renderizar items del menú
        function renderMenuItems() {
            // Obtener items filtrados
            const filteredItems = getFilteredItems();
            
            // Limpiar grid
            menuGrid.innerHTML = '';
            
            // Mostrar mensaje si no hay resultados
            if (filteredItems.length === 0) {
                const categoryName = categories.find(cat => cat.id === activeCategory)?.name || "esta categoría";
                
                menuGrid.innerHTML = `
                    <div class="no-results">
                        <i class="fas fa-search"></i>
                        <h3>No encontramos platos con esos filtros</h3>
                        <p>No hay items en ${categoryName.toLowerCase()} que cumplan con los filtros seleccionados.</p>
                        <button class="clear-filters" style="padding: 0.8rem 1.5rem; font-size: 1rem; margin-right: 10px;" id="clearFiltersBtn">Limpiar filtros</button>
                        <button class="clear-filters" style="padding: 0.8rem 1.5rem; font-size: 1rem; background: var(--primary); color: white;" id="showAllBtn">Ver todos</button>
                    </div>
                `;
                
                // Añadir event listeners a los botones
                document.getElementById('clearFiltersBtn').addEventListener('click', clearAllFilters);
                document.getElementById('showAllBtn').addEventListener('click', () => {
                    activeCategory = "todos";
                    updateCategoryUI();
                    renderMenuItems();
                });
                
                return;
            }
            
            // Renderizar items
            filteredItems.forEach(item => {
                const menuItem = document.createElement('div');
                menuItem.className = 'menu-item';
                
                // Crear etiquetas HTML
                let tagsHTML = '';
                item.tags.forEach(tag => {
                    const tagNames = {
                        'vegano': 'Vegano',
                        'vegetariano': 'Vegetariano',
                        'sin-gluten': 'Sin Gluten',
                        'sin-lactosa': 'Sin Lactosa',
                        'bajo-sodio': 'Bajo en Sodio',
                        'sin-pescado': 'Sin Pescado',
                        'sin-soya': 'Sin Soya',
                        'picante': 'Picante'
                    };
                    
                    tagsHTML += `<span class="menu-tag ${tag}">${tagNames[tag] || tag}</span>`;
                });
                
                // Badge si existe
                const badgeHTML = item.badge ? `<div class="item-badge">${item.badge}</div>` : '';
                
                menuItem.innerHTML = `
                    ${badgeHTML}
                    <div class="menu-item-image" style="background-image: url('${item.image}')"></div>
                    <div class="menu-item-content">
                        <div class="menu-item-header">
                            <h3 class="menu-item-title">${item.name}</h3>
                            <span class="menu-item-price">${item.price}</span>
                        </div>
                        <p class="menu-item-desc">${item.description}</p>
                        <div class="menu-item-tags">
                            ${tagsHTML}
                        </div>
                    </div>
                `;
                
                menuGrid.appendChild(menuItem);
            });
        }

        // Limpiar todos los filtros
        function clearAllFilters() {
            activeFilters.preferences = [];
            activeFilters.restrictions = [];
            activeFilters.spice = [];
            
            updateActiveFiltersDisplay();
            updateFilterIndicator();
            renderMenuItems();
            
            // Desmarcar todos los botones de filtro
            filterOptions.forEach(option => {
                if (option.id !== 'applyFilters') {
                    option.classList.remove('active');
                }
            });
        }

        // Inicializar la aplicación
        function init() {
            createCategoryList();
            updateCategoryUI();
            renderMenuItems();
            updateActiveFiltersDisplay();
            updateFilterIndicator();
        }

        // Cerrar paneles al hacer swipe (para móviles)
        let touchStartX = 0;
        let touchEndX = 0;
        
        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        }, false);
        
        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, false);
        
        function handleSwipe() {
            const swipeThreshold = 50;
            
            // Swipe izquierda (cerrar panel derecho)
            if (touchStartX - touchEndX > swipeThreshold && filterPanel.classList.contains('active')) {
                hideFilterPanel();
            }
            
            // Swipe derecha (cerrar panel izquierdo)
            if (touchEndX - touchStartX > swipeThreshold && categoryPanel.classList.contains('active')) {
                hideCategoryPanel();
            }
        }

        // Ejecutar al cargar
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>